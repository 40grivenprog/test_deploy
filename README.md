# ğŸš€ ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ EKS Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹ Ñ ArgoCD

Ğ”ĞµÑˆÑ‘Ğ²Ğ¾Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ Ğ´ĞµĞ¿Ğ»Ğ¾Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹ Ğ½Ğ° AWS EKS Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Terraform, Helm, ArgoCD Ğ¸ GitOps.

## ğŸ’° Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ: ~$12/Ğ¼ĞµÑÑÑ†

- **EKS**: $10/Ğ¼ĞµÑÑÑ† (1 Ğ½Ğ¾Ğ´Ğ° t3.micro)
- **ECR**: $2/Ğ¼ĞµÑÑÑ† (Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²)
- **NAT Gateway**: $0/Ğ¼ĞµÑÑÑ† (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿ÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ´ÑĞµÑ‚Ğ¸)

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AWS Infrastructure                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  VPC (10.0.0.0/16)                                          â”‚
â”‚  â”œâ”€â”€ Public Subnet (10.0.1.0/24) - eu-central-1a           â”‚
â”‚  â”‚   â””â”€â”€ EKS Cluster + 1 Node (t3.micro)                   â”‚
â”‚  â””â”€â”€ Internet Gateway                                       â”‚
â”‚      â””â”€â”€ Route Table (0.0.0.0/0 â†’ IGW)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ECR Repository                                             â”‚
â”‚  â””â”€â”€ Docker Images                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  EKS Cluster                                                â”‚
â”‚  â”œâ”€â”€ 1 Worker Node (t3.micro)                              â”‚
â”‚  â”œâ”€â”€ ArgoCD (GitOps)                                       â”‚
â”‚  â””â”€â”€ Nginx (Helm Chart)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

### 1. Ğ Ğ°Ğ·Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ

```bash
cd infra
terraform init
terraform apply
```

### 2. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ kubectl Ğ¸ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ArgoCD

```bash
./scripts/setup.sh
```

### 3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ArgoCD Application

```bash
# ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ repoURL Ğ² argocd-app.yaml
kubectl apply -f argocd-app.yaml
```

### 4. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ GitHub Secrets

Ğ’ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ñ… Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ Ğ´Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ:
- `AWS_ACCESS_KEY_ID`
- `AWS_SECRET_ACCESS_KEY`

### 5. Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹

```bash
git push origin main
```

## ğŸ“ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
test_deploy/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ main.go                 # Go Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
â”œâ”€â”€ infra/
â”‚   â”œâ”€â”€ main.tf                 # VPC + EKS
â”‚   â”œâ”€â”€ ecr.tf                  # ECR Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹
â”‚   â”œâ”€â”€ variables.tf            # ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ
â”‚   â””â”€â”€ outputs.tf              # Outputs
â”œâ”€â”€ helm/
â”‚   â””â”€â”€ nginx/
â”‚       â”œâ”€â”€ Chart.yaml          # Helm Ñ‡Ğ°Ñ€Ñ‚
â”‚       â”œâ”€â”€ values.yaml         # ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
â”‚       â””â”€â”€ templates/
â”‚           â”œâ”€â”€ deployment.yaml # K8s deployment
â”‚           â”œâ”€â”€ service.yaml    # K8s service
â”‚           â””â”€â”€ _helpers.tpl    # Helper templates
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ setup.sh               # ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° kubectl + ArgoCD
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ deploy.yml         # CI/CD pipeline
â”œâ”€â”€ argocd-app.yaml            # ArgoCD Application
â”œâ”€â”€ Dockerfile                 # Docker Ğ¾Ğ±Ñ€Ğ°Ğ·
â””â”€â”€ README.md                  # Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
```

## ğŸ›ï¸ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· ArgoCD

### Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº ArgoCD UI

```bash
# Port forward
kubectl port-forward svc/argocd-server -n argocd 8080:443

# ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ
# https://localhost:8080
# Username: admin
# Password: [Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ‡ĞµÑ€ĞµĞ· setup.sh]
```

### ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ Ğ² ArgoCD

- **Sync** - Ğ¿Ñ€Ğ¸Ğ½ÑƒĞ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
- **Refresh** - Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ
- **Rollback** - Ğ¾Ñ‚ĞºĞ°Ñ‚ Ğº Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞ¹ Ğ²ĞµÑ€ÑĞ¸Ğ¸
- **Edit** - Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸

## ğŸŒ Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

```bash
# ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ IP Ğ½Ğ¾Ğ´Ñ‹
kubectl get nodes -o wide

# Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº nginx
# http://[NODE_IP]:30080
```

## ğŸ”§ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°

### Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ñ€ĞµĞ³Ğ¸Ğ¾Ğ½Ğ°

```bash
# Ğ’ infra/variables.tf
variable "aws_region" {
  default = "us-east-1"  # Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚Ğµ Ğ½Ğ° Ğ½ÑƒĞ¶Ğ½Ñ‹Ğ¹ Ñ€ĞµĞ³Ğ¸Ğ¾Ğ½
}
```

### ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

```bash
# Ğ’ helm/nginx/values.yaml
replicaCount: 3  # Ğ£Ğ²ĞµĞ»Ğ¸Ñ‡ÑŒÑ‚Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ñ€ĞµĞ¿Ğ»Ğ¸Ğº
```

### Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹

1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Helm Ñ‡Ğ°Ñ€Ñ‚ Ğ² `helm/`
2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ ArgoCD Application
3. ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚Ğµ Ñ‡ĞµÑ€ĞµĞ· `kubectl apply -f`

## ğŸ› ï¸ Ğ£ÑÑ‚Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ½ĞµĞ¿Ğ¾Ğ»Ğ°Ğ´Ğ¾Ğº

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ‚Ğ°Ñ‚ÑƒÑĞ° ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°

```bash
kubectl cluster-info
kubectl get nodes
```

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ArgoCD

```bash
kubectl get pods -n argocd
kubectl logs -n argocd deployment/argocd-server
```

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

```bash
kubectl get pods
kubectl logs deployment/nginx-nginx
```

## ğŸ§¹ ĞÑ‡Ğ¸ÑÑ‚ĞºĞ°

```bash
# Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ArgoCD Application
kubectl delete -f argocd-app.yaml

# Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ArgoCD
helm uninstall argocd -n argocd

# Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ
cd infra
terraform destroy
```

## ğŸ“š ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹

```bash
# ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ArgoCD Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d

# ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ»Ğ¾Ğ³Ğ¾Ğ² ArgoCD
kubectl logs -n argocd deployment/argocd-server

# Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹ ArgoCD
kubectl get applications -n argocd

# Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
kubectl patch application nginx-app -n argocd --type='merge' -p='{"spec":{"syncPolicy":{"automated":{"prune":true,"selfHeal":true}}}}'
```

## ğŸ¯ ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°

âœ… **Ğ”Ñ‘ÑˆĞµĞ²Ğ¾**: $12/Ğ¼ĞµÑÑÑ† Ğ²Ğ¼ĞµÑÑ‚Ğ¾ $60+  
âœ… **ĞŸÑ€Ğ¾ÑÑ‚Ğ¾**: ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°  
âœ… **GitOps**: ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹  
âœ… **ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾**: Ğ›ĞµĞ³ĞºĞ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ´Ñ‹  
âœ… **Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾**: Security Groups Ğ·Ğ°Ñ‰Ğ¸Ñ‰Ğ°ÑÑ‚  

## ğŸ“ ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°

ĞŸÑ€Ğ¸ Ğ²Ğ¾Ğ·Ğ½Ğ¸ĞºĞ½Ğ¾Ğ²ĞµĞ½Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼:
1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸: `kubectl logs`
2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑ: `kubectl get all`
3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ ArgoCD: `kubectl get applications -n argocd` 